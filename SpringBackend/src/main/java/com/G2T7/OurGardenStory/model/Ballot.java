package com.G2T7.OurGardenStory.model;

import javax.validation.constraints.NotNull;

import com.amazonaws.services.dynamodbv2.datamodeling.*;
import lombok.*;

import java.time.*;
import java.util.List;

@Getter
@Setter
@Data
@AllArgsConstructor
@NoArgsConstructor
@DynamoDBTable(tableName = "Ballot")

public class Ballot {
    @DynamoDBHashKey
    @DynamoDBAutoGeneratedKey
    private String ballotId;

    @DynamoDBTypeConverted( converter = LocalDateTimeConverter.class )
    private LocalDateTime submitDateTime;

    @DynamoDBTypeConverted( converter = LocalDateTimeConverter.class )
    private LocalDateTime leaseStart;

    @DynamoDBAttribute
    private String leaseDuration = "3Y";

    @DynamoDBAttribute
    private String status = "PENDING";

    @DynamoDBTypeConverted( converter = GardenConverter.class )
    private Garden garden;

    @DynamoDBTypeConverted( converter = LocalDateTimeConverter.class )
    private LocalDateTime startDateTime;

    @DynamoDBAttribute
    private String username;

    static public class GardenConverter implements DynamoDBTypeConverter<String, Garden> {
        @Override
        public String convert(final Garden garden) { return garden.toString();}

        @Override
        public Garden unconvert(final String stringValue) { return new Garden();} // this is rubbish, but we won't use it
    }

    static public class LocalDateTimeConverter implements DynamoDBTypeConverter<String, LocalDateTime> {

        @Override
        public String convert( final LocalDateTime time ) {
            return time.toString();
        }
        @Override
        public LocalDateTime unconvert( final String stringValue ) {
            return LocalDateTime.parse(stringValue);
        }
    }
}
